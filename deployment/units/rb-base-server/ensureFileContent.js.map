{"version":3,"sources":["../../../units/rb-base-server/ensureFileContent.js"],"names":["fs","fsWithCallbacks","promises","ensureFileContent","fileName","currentFileContent","newFileContent","logToConsole","readFile","toString","err","code","NestedError","console","log","chalk","white","bgGreen","writeFile","bgBlackBright"],"mappings":";;AAEA;;AAEA;AACA,gF;;AAEA,MAAMA,EAAE,GAAGC,YAAgBC,QAA3B;;AAEA;;AAE+BC,iB,GAAf,eAAeA,iBAAf;AACdC,QADc;AAEdC,kBAFc;AAGdC,cAHc;AAIdC,YAJc;AAKd;AACA;AACA,MAAIF,kBAAkB,IAAI,IAA1B,EAAgC;AAC9B,QAAI;AACFA,MAAAA,kBAAkB,GAAG,CAAC,MAAML,EAAE,CAACQ,QAAH,CAAYJ,QAAZ,CAAP,EAA8BK,QAA9B,EAArB;AACD,KAFD,CAEE,OAAOC,GAAP,EAAY;AACZ,UAAIA,GAAG,CAACC,IAAJ,KAAa,QAAjB,EAA2B;AACzB,cAAM,IAAIC,0BAAJ,CAAgB,0CAAhB,EAA4DF,GAA5D,CAAN;AACD;AACF;AACF;;AAED,MAAIL,kBAAkB,KAAKC,cAA3B,EAA2C;AACzC,QAAIC,YAAJ,EAAkBM,OAAO,CAACC,GAAR,CAAYC,eAAMC,KAAN,CAAYC,OAAZ,CAAoB,WAApB,IAAmC,GAAnC,GAAyCb,QAArD;AAClB,UAAMJ,EAAE,CAACkB,SAAH,CAAad,QAAb,EAAuBE,cAAvB,EAAuC,MAAvC,CAAN;AACD,GAHD,MAGO;AACL,QAAIC,YAAJ,EAAkBM,OAAO,CAACC,GAAR,CAAYC,eAAMC,KAAN,CAAYG,aAAZ,CAA0B,WAA1B,IAAyC,GAAzC,GAA+Cf,QAA3D;AACnB;AACF,C","sourcesContent":["// @flow\n\nimport fsWithCallbacks from 'fs'\n\nimport chalk from 'chalk'\nimport NestedError from 'nested-error-stacks'\n\nconst fs = fsWithCallbacks.promises\n\n//\n\nexport default (async function ensureFileContent(\n  fileName: string,\n  currentFileContent: ?string,\n  newFileContent: string,\n  logToConsole: boolean,\n) {\n  // If the current file content is not provided, get it\n  if (currentFileContent == null) {\n    try {\n      currentFileContent = (await fs.readFile(fileName)).toString()\n    } catch (err) {\n      if (err.code !== 'ENOENT') {\n        throw new NestedError('rb-base-server ensureFileContent: Failed', err)\n      }\n    }\n  }\n\n  if (currentFileContent !== newFileContent) {\n    if (logToConsole) console.log(chalk.white.bgGreen('[written]') + ' ' + fileName)\n    await fs.writeFile(fileName, newFileContent, 'utf8')\n  } else {\n    if (logToConsole) console.log(chalk.white.bgBlackBright('[skipped]') + ' ' + fileName)\n  }\n})\n"],"file":"ensureFileContent.js"}